{"is_source_file": true, "format": "JavaScript", "description": "This JavaScript module manages user reviews and related data for recipes, stored in local storage. It provides functions to get or create user info, handle reviews (add, update, delete), retrieve reviews for specific recipes, compute rating summaries, and perform analytics across recipes.", "external_files": [], "external_methods": [], "published": ["getOrCreateUser", "setUserDisplayName", "getAllReviews", "setAllReviews", "getReviewsForRecipe", "getRatingSummary", "upsertMyReview", "deleteMyReview", "purgeReviewsForRecipe", "computeRatingsAnalytics"], "classes": [], "methods": [{"name": "getOrCreateUser()", "description": "Retrieves or creates a persistent local user ID and display name, stored in local storage, generating a UUID if necessary.", "scope": "", "scopeKind": ""}, {"name": "setUserDisplayName(name)", "description": "Sets or updates the local storage display name for the current user.", "scope": "", "scopeKind": ""}, {"name": "getAllReviews()", "description": "Reads and returns all reviews stored in local storage.", "scope": "", "scopeKind": ""}, {"name": "setAllReviews(reviews)", "description": "Persists an array of reviews to local storage.", "scope": "", "scopeKind": ""}, {"name": "getReviewsForRecipe(recipeId)", "description": "Filters and retrieves reviews corresponding to a specific recipe ID.", "scope": "", "scopeKind": ""}, {"name": "getRatingSummary(recipeId)", "description": "Calculates the average rating and review count for a specific recipe.", "scope": "", "scopeKind": ""}, {"name": "upsertMyReview({ recipeId, rating, comment })", "description": "Inserts or updates a review for the current user for a given recipe, ensuring one review per user per recipe.", "scope": "", "scopeKind": ""}, {"name": "deleteMyReview(recipeId)", "description": "Removes the current user's review for a specified recipe.", "scope": "", "scopeKind": ""}, {"name": "purgeReviewsForRecipe(recipeId)", "description": "Deletes all reviews associated with a specific recipe, e.g., when the recipe is deleted.", "scope": "", "scopeKind": ""}, {"name": "computeRatingsAnalytics(recipes)", "description": "Computes aggregate rating statistics across recipes, including overall average, distribution, and per-recipe summaries.", "scope": "", "scopeKind": ""}, {"name": "clampRating(r)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "genUUID()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "truncateComment(s)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["window.localStorage.getItem", "window.localStorage.setItem", "JSON.parse", "JSON.stringify", "Array.isArray", "Array.prototype.filter", "Array.prototype.reduce", "Array.prototype.findIndex", "Map", "Set", "Number", "String", "Date", "Math.round"], "search-terms": ["localStorage reviews", "recipe review functions", "review analytics", "review upsert", "getReviewsForRecipe", "computeRatingsAnalytics"], "state": 2, "file_id": 31, "knowledge_revision": 121, "git_revision": "", "ctags": [{"_type": "tag", "name": "1", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class"}, {"_type": "tag", "name": "2", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class"}, {"_type": "tag", "name": "3", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class"}, {"_type": "tag", "name": "4", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class"}, {"_type": "tag", "name": "5", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "property", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class"}, {"_type": "tag", "name": "REVIEWS_LS_KEY", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^const REVIEWS_LS_KEY = 'app_reviews:v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "USER_ID_LS_KEY", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^const USER_ID_LS_KEY = 'app_user_id:v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "USER_NAME_LS_KEY", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^const USER_NAME_LS_KEY = 'app_user_name:v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "clampRating", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^function clampRating(r) {$/", "language": "JavaScript", "kind": "function", "signature": "(r)"}, {"_type": "tag", "name": "computeRatingsAnalytics", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function computeRatingsAnalytics(recipes) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipes)"}, {"_type": "tag", "name": "deleteMyReview", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function deleteMyReview(recipeId) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipeId)"}, {"_type": "tag", "name": "distribution", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^  const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };$/", "language": "JavaScript", "kind": "class", "scope": "computeRatingsAnalytics", "scopeKind": "class"}, {"_type": "tag", "name": "genUUID", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^function genUUID() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getAllReviews", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function getAllReviews() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getOrCreateUser", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function getOrCreateUser() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getRatingSummary", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function getRatingSummary(recipeId) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipeId)"}, {"_type": "tag", "name": "getReviewsForRecipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function getReviewsForRecipe(recipeId) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipeId)"}, {"_type": "tag", "name": "purgeReviewsForRecipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function purgeReviewsForRecipe(recipeId) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipeId)"}, {"_type": "tag", "name": "setAllReviews", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function setAllReviews(reviews) {$/", "language": "JavaScript", "kind": "function", "signature": "(reviews)"}, {"_type": "tag", "name": "setUserDisplayName", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function setUserDisplayName(name) {$/", "language": "JavaScript", "kind": "function", "signature": "(name)"}, {"_type": "tag", "name": "truncateComment", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^function truncateComment(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "upsertMyReview", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/reviews.js", "pattern": "/^export function upsertMyReview({ recipeId, rating, comment }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ recipeId, rating, comment })"}], "hash": "d67216e9aa24c3f2555688a011b0923d", "format-version": 4, "code-base-name": "frontend", "filename": "frontend/src/data/reviews.js", "fields": [{"name": "const distribution = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };", "scope": "computeRatingsAnalytics.distribution", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"121": ""}]}
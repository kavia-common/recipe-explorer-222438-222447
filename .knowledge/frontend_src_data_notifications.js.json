{"is_source_file": true, "format": "JavaScript", "description": "Client-side notifications management module for handling notification preferences, permission requests, scheduled notifications, and fallback UI in a recipe explorer web application.", "external_files": ["window.localStorage", "Notification"], "external_methods": ["Notification.requestPermission", "window.dispatchEvent", "window.setInterval", "window.clearInterval"], "published": ["getNotificationSettings", "saveNotificationSettings", "requestBrowserPermission", "getPermissionState", "notify", "validateHHMM", "startNotificationScheduler"], "classes": [], "methods": [{"name": "getNotificationSettings()", "description": "Returns a merged notification settings object from localStorage, or defaults if parsing fails.", "scope": "", "scopeKind": ""}, {"name": "saveNotificationSettings(next)", "description": "Persists notification settings to localStorage safely.", "scope": "", "scopeKind": ""}, {"name": "requestBrowserPermission()", "description": "Requests notification permission from the browser, returns permission status.", "scope": "", "scopeKind": ""}, {"name": "getPermissionState()", "description": "Returns the current notification permission state or 'unsupported' if notifications are not supported.", "scope": "", "scopeKind": ""}, {"name": "notify({ title, body, icon, onClick })", "description": "Displays a system notification if permissions are granted, or falls back to an in-app toast or alert.", "scope": "", "scopeKind": ""}, {"name": "validateHHMM(s)", "description": "Validates and normalizes HH:MM (24-hour) string, returns null if invalid.", "scope": "", "scopeKind": ""}, {"name": "startNotificationScheduler({ getApprovedRecipes, getTodayPlan })", "description": "Starts a polling scheduler that regularly checks conditions to send notifications based on user settings.", "scope": "", "scopeKind": ""}, {"name": "collectTodayPlan(getTodayPlan)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "deepMerge(base, extra)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "formatCooking(mins)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "getDefaultIcon()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "isPlainObject(v)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "isTimeReachedToday(now, hhmm)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "parseHHMMToMinutes(hhmm)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pickDaily(recipes, todayISO)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "safeArr(a)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "stringHash(s)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "tick({ getApprovedRecipes, getTodayPlan })", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "toISODate(d = new Date())", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["tick({ getApprovedRecipes, getTodayPlan })", "getNotificationSettings()", "saveNotificationSettings(settings)"], "search-terms": ["notifications", "notification preferences", "notification scheduling", "browser permissions", "daily recipe suggestion", "meal reminders", "recipe alerts", "localStorage", "Notification API"], "state": 2, "file_id": 39, "knowledge_revision": 158, "git_revision": "418ba5a73fac37feac49319a745982328a4c65a6", "ctags": [{"_type": "tag", "name": "DEFAULTS", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^const DEFAULTS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "LS_KEY", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^const LS_KEY = 'app_notifications:v1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^      body: body || '',$/", "language": "JavaScript", "kind": "property", "scope": "notify.payload", "scopeKind": "class"}, {"_type": "tag", "name": "collectTodayPlan", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function collectTodayPlan(getTodayPlan) {$/", "language": "JavaScript", "kind": "function", "signature": "(getTodayPlan)"}, {"_type": "tag", "name": "dailySuggestion", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^  dailySuggestion: {$/", "language": "JavaScript", "kind": "class", "scope": "DEFAULTS", "scopeKind": "class"}, {"_type": "tag", "name": "deepMerge", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function deepMerge(base, extra) {$/", "language": "JavaScript", "kind": "function", "signature": "(base, extra)"}, {"_type": "tag", "name": "enabled", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    enabled: false,$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class"}, {"_type": "tag", "name": "enabled", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    enabled: false,$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.mealReminders", "scopeKind": "class"}, {"_type": "tag", "name": "enabled", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    enabled: false,$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.newRecipeAlerts", "scopeKind": "class"}, {"_type": "tag", "name": "formatCooking", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function formatCooking(mins) {$/", "language": "JavaScript", "kind": "function", "signature": "(mins)"}, {"_type": "tag", "name": "getDefaultIcon", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function getDefaultIcon() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getNotificationSettings", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function getNotificationSettings() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getPermissionState", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function getPermissionState() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "icon", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^      icon: icon || getDefaultIcon(),$/", "language": "JavaScript", "kind": "property", "scope": "notify.payload", "scopeKind": "class"}, {"_type": "tag", "name": "isPlainObject", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function isPlainObject(v) { return v && typeof v === 'object' && !Array.isArray(v); }$/", "language": "JavaScript", "kind": "function", "signature": "(v)"}, {"_type": "tag", "name": "isTimeReachedToday", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function isTimeReachedToday(now, hhmm) {$/", "language": "JavaScript", "kind": "function", "signature": "(now, hhmm)"}, {"_type": "tag", "name": "lastSeenRecipeIds", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    lastSeenRecipeIds: [], \\/\\/ recipe ids observed as approved$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.newRecipeAlerts", "scopeKind": "class"}, {"_type": "tag", "name": "lastSentISO", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    lastSentISO: null,$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class"}, {"_type": "tag", "name": "lastSentISOByDate", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    lastSentISOByDate: {}, \\/\\/ map of yyyy-mm-dd => true (sent)$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.mealReminders", "scopeKind": "class"}, {"_type": "tag", "name": "mealReminders", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^  mealReminders: {$/", "language": "JavaScript", "kind": "class", "scope": "DEFAULTS", "scopeKind": "class"}, {"_type": "tag", "name": "newRecipeAlerts", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^  newRecipeAlerts: {$/", "language": "JavaScript", "kind": "class", "scope": "DEFAULTS", "scopeKind": "class"}, {"_type": "tag", "name": "notify", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function notify({ title, body, icon, onClick }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ title, body, icon, onClick })"}, {"_type": "tag", "name": "parseHHMMToMinutes", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function parseHHMMToMinutes(hhmm) {$/", "language": "JavaScript", "kind": "function", "signature": "(hhmm)"}, {"_type": "tag", "name": "payload", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    const payload = {$/", "language": "JavaScript", "kind": "class", "scope": "notify", "scopeKind": "class"}, {"_type": "tag", "name": "pickDaily", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function pickDaily(recipes, todayISO) {$/", "language": "JavaScript", "kind": "function", "signature": "(recipes, todayISO)"}, {"_type": "tag", "name": "requestBrowserPermission", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export async function requestBrowserPermission() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "safeArr", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function safeArr(a) { return Array.isArray(a) ? a : []; }$/", "language": "JavaScript", "kind": "function", "signature": "(a)"}, {"_type": "tag", "name": "saveNotificationSettings", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function saveNotificationSettings(next) {$/", "language": "JavaScript", "kind": "function", "signature": "(next)"}, {"_type": "tag", "name": "startNotificationScheduler", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function startNotificationScheduler({ getApprovedRecipes, getTodayPlan }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ getApprovedRecipes, getTodayPlan })"}, {"_type": "tag", "name": "stringHash", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function stringHash(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "tick", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function tick({ getApprovedRecipes, getTodayPlan }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ getApprovedRecipes, getTodayPlan })"}, {"_type": "tag", "name": "time", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    time: '09:00', \\/\\/ 24h local$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class"}, {"_type": "tag", "name": "time", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^    time: '18:00', \\/\\/ single reminder per day$/", "language": "JavaScript", "kind": "property", "scope": "DEFAULTS.mealReminders", "scopeKind": "class"}, {"_type": "tag", "name": "timestamp", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^      timestamp: Date.now(),$/", "language": "JavaScript", "kind": "property", "scope": "notify.payload", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^      title: title || 'Notification',$/", "language": "JavaScript", "kind": "property", "scope": "notify.payload", "scopeKind": "class"}, {"_type": "tag", "name": "toISODate", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^function toISODate(d = new Date()) { const x = new Date(d); x.setHours(0,0,0,0); return x.toISOS/", "language": "JavaScript", "kind": "function", "signature": "(d = new Date())"}, {"_type": "tag", "name": "validateHHMM", "path": "/home/kavia/workspace/code-generation/recipe-explorer-222438-222447/frontend/src/data/notifications.js", "pattern": "/^export function validateHHMM(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}], "hash": "d65dbfd1f35b8480fb344d96881f7e9e", "format-version": 4, "code-base-name": "frontend", "filename": "frontend/src/data/notifications.js", "fields": [{"name": "body: body || '',", "scope": "notify.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "enabled: false,", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class", "description": "unavailable"}, {"name": "icon: icon || getDefaultIcon(),", "scope": "notify.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "lastSeenRecipeIds: [], \\/\\/ recipe ids observed as approved", "scope": "DEFAULTS.newRecipeAlerts", "scopeKind": "class", "description": "unavailable"}, {"name": "lastSentISO: null,", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class", "description": "unavailable"}, {"name": "lastSentISOByDate: {}, \\/\\/ map of yyyy-mm-dd => true (sent)", "scope": "DEFAULTS.mealReminders", "scopeKind": "class", "description": "unavailable"}, {"name": "time: '09:00', \\/\\/ 24h local", "scope": "DEFAULTS.dailySuggestion", "scopeKind": "class", "description": "unavailable"}, {"name": "time: '18:00', \\/\\/ single reminder per day", "scope": "DEFAULTS.mealReminders", "scopeKind": "class", "description": "unavailable"}, {"name": "timestamp: Date.now(),", "scope": "notify.payload", "scopeKind": "class", "description": "unavailable"}, {"name": "title: title || 'Notification',", "scope": "notify.payload", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"158": "418ba5a73fac37feac49319a745982328a4c65a6"}]}